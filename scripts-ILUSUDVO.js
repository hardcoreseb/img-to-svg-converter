(function(){"use strict";function k(){var h=this;this.versionnumber="1.2.6",this.imageToSVG=function(e,a,r){r=h.checkoptions(r),h.loadImage(e,function(t){a(h.imagedataToSVG(h.getImgdata(t),r))},r)},this.imagedataToSVG=function(e,a){a=h.checkoptions(a);var r=h.imagedataToTracedata(e,a);return h.getsvgstring(r,a)},this.imageToTracedata=function(e,a,r){r=h.checkoptions(r),h.loadImage(e,function(t){a(h.imagedataToTracedata(h.getImgdata(t),r))},r)},this.imagedataToTracedata=function(e,a){a=h.checkoptions(a);var r=h.colorquantization(e,a);if(a.layering===0)for(var t={layers:[],palette:r.palette,width:r.array[0].length-2,height:r.array.length-2},o=0;o<r.palette.length;o++){var l=h.batchtracepaths(h.internodes(h.pathscan(h.layeringstep(r,o),a.pathomit),a),a.ltres,a.qtres);t.layers.push(l)}else{var c=h.layering(r);a.layercontainerid&&h.drawLayers(c,h.specpalette,a.scale,a.layercontainerid);var n=h.batchpathscan(c,a.pathomit),i=h.batchinternodes(n,a),t={layers:h.batchtracelayers(i,a.ltres,a.qtres),palette:r.palette,width:e.width,height:e.height}}return t},this.optionpresets={default:{corsenabled:!1,ltres:1,qtres:1,pathomit:8,rightangleenhance:!0,colorsampling:2,numberofcolors:16,mincolorratio:0,colorquantcycles:3,layering:0,strokewidth:1,linefilter:!1,scale:1,roundcoords:1,viewbox:!1,desc:!1,lcpr:0,qcpr:0,blurradius:0,blurdelta:20},posterized1:{colorsampling:0,numberofcolors:2},posterized2:{numberofcolors:4,blurradius:5},curvy:{ltres:.01,linefilter:!0,rightangleenhance:!1},sharp:{qtres:.01,linefilter:!1},detailed:{pathomit:0,roundcoords:2,ltres:.5,qtres:.5,numberofcolors:64},smoothed:{blurradius:5,blurdelta:64},grayscale:{colorsampling:0,colorquantcycles:1,numberofcolors:7},fixedpalette:{colorsampling:0,colorquantcycles:1,numberofcolors:27},randomsampling1:{colorsampling:1,numberofcolors:8},randomsampling2:{colorsampling:1,numberofcolors:64},artistic1:{colorsampling:0,colorquantcycles:1,pathomit:0,blurradius:5,blurdelta:64,ltres:.01,linefilter:!0,numberofcolors:16,strokewidth:2},artistic2:{qtres:.01,colorsampling:0,colorquantcycles:1,numberofcolors:4,strokewidth:0},artistic3:{qtres:10,ltres:10,numberofcolors:8},artistic4:{qtres:10,ltres:10,numberofcolors:64,blurradius:5,blurdelta:256,strokewidth:2},posterized3:{ltres:1,qtres:1,pathomit:20,rightangleenhance:!0,colorsampling:0,numberofcolors:3,mincolorratio:0,colorquantcycles:3,blurradius:3,blurdelta:20,strokewidth:0,linefilter:!1,roundcoords:1,pal:[{r:0,g:0,b:100,a:255},{r:255,g:255,b:255,a:255}]}},this.checkoptions=function(e){e=e||{},typeof e=="string"&&(e=e.toLowerCase(),h.optionpresets[e]?e=h.optionpresets[e]:e={});for(var a=Object.keys(h.optionpresets.default),r=0;r<a.length;r++)e.hasOwnProperty(a[r])||(e[a[r]]=h.optionpresets.default[a[r]]);return e},this.colorquantization=function(e,a){var r=[],t=0,o,l,c,n=[],i=e.width*e.height,s,y,d,b,g;if(e.data.length<i*4){for(var f=new Uint8ClampedArray(i*4),u=0;u<i;u++)f[u*4]=e.data[u*3],f[u*4+1]=e.data[u*3+1],f[u*4+2]=e.data[u*3+2],f[u*4+3]=255;e.data=f}for(y=0;y<e.height+2;y++)for(r[y]=[],s=0;s<e.width+2;s++)r[y][s]=-1;for(a.pal?g=a.pal:a.colorsampling===0?g=h.generatepalette(a.numberofcolors):a.colorsampling===1?g=h.samplepalette(a.numberofcolors,e):g=h.samplepalette2(a.numberofcolors,e),a.blurradius>0&&(e=h.blur(e,a.blurradius,a.blurdelta)),b=0;b<a.colorquantcycles;b++){if(b>0)for(d=0;d<g.length;d++)n[d].n>0&&(g[d]={r:Math.floor(n[d].r/n[d].n),g:Math.floor(n[d].g/n[d].n),b:Math.floor(n[d].b/n[d].n),a:Math.floor(n[d].a/n[d].n)}),n[d].n/i<a.mincolorratio&&b<a.colorquantcycles-1&&(g[d]={r:Math.floor(Math.random()*255),g:Math.floor(Math.random()*255),b:Math.floor(Math.random()*255),a:Math.floor(Math.random()*255)});for(s=0;s<g.length;s++)n[s]={r:0,g:0,b:0,a:0,n:0};for(y=0;y<e.height;y++)for(s=0;s<e.width;s++){for(t=(y*e.width+s)*4,c=0,l=1024,d=0;d<g.length;d++)o=(g[d].r>e.data[t]?g[d].r-e.data[t]:e.data[t]-g[d].r)+(g[d].g>e.data[t+1]?g[d].g-e.data[t+1]:e.data[t+1]-g[d].g)+(g[d].b>e.data[t+2]?g[d].b-e.data[t+2]:e.data[t+2]-g[d].b)+(g[d].a>e.data[t+3]?g[d].a-e.data[t+3]:e.data[t+3]-g[d].a),o<l&&(l=o,c=d);n[c].r+=e.data[t],n[c].g+=e.data[t+1],n[c].b+=e.data[t+2],n[c].a+=e.data[t+3],n[c].n++,r[y+1][s+1]=c}}return{array:r,palette:g}},this.samplepalette=function(e,a){for(var r,t=[],o=0;o<e;o++)r=Math.floor(Math.random()*a.data.length/4)*4,t.push({r:a.data[r],g:a.data[r+1],b:a.data[r+2],a:a.data[r+3]});return t},this.samplepalette2=function(e,a){for(var r,t=[],o=Math.ceil(Math.sqrt(e)),l=Math.ceil(e/o),c=a.width/(o+1),n=a.height/(l+1),i=0;i<l;i++)for(var s=0;s<o&&t.length!==e;s++)r=Math.floor((i+1)*n*a.width+(s+1)*c)*4,t.push({r:a.data[r],g:a.data[r+1],b:a.data[r+2],a:a.data[r+3]});return t},this.generatepalette=function(e){var a=[],r,t,o;if(e<8)for(var l=Math.floor(255/(e-1)),c=0;c<e;c++)a.push({r:c*l,g:c*l,b:c*l,a:255});else{var n=Math.floor(Math.pow(e,.3333333333333333)),i=Math.floor(255/(n-1)),s=e-n*n*n;for(r=0;r<n;r++)for(t=0;t<n;t++)for(o=0;o<n;o++)a.push({r:r*i,g:t*i,b:o*i,a:255});for(r=0;r<s;r++)a.push({r:Math.floor(Math.random()*255),g:Math.floor(Math.random()*255),b:Math.floor(Math.random()*255),a:Math.floor(Math.random()*255)})}return a},this.layering=function(e){var a=[],r=0,t=e.array.length,o=e.array[0].length,l,c,n,i,s,y,d,b,g,f,u;for(u=0;u<e.palette.length;u++)for(a[u]=[],f=0;f<t;f++)for(a[u][f]=[],g=0;g<o;g++)a[u][f][g]=0;for(f=1;f<t-1;f++)for(g=1;g<o-1;g++)r=e.array[f][g],l=e.array[f-1][g-1]===r?1:0,c=e.array[f-1][g]===r?1:0,n=e.array[f-1][g+1]===r?1:0,i=e.array[f][g-1]===r?1:0,s=e.array[f][g+1]===r?1:0,y=e.array[f+1][g-1]===r?1:0,d=e.array[f+1][g]===r?1:0,b=e.array[f+1][g+1]===r?1:0,a[r][f+1][g+1]=1+s*2+b*4+d*8,i||(a[r][f+1][g]=2+d*4+y*8),c||(a[r][f][g+1]=0+n*2+s*4+8),l||(a[r][f][g]=0+c*2+4+i*8);return a},this.layeringstep=function(e,a){var r=[],t=0,o=e.array.length,l=e.array[0].length,c,n,i,s,y,d,b,g,f,u,v;for(u=0;u<o;u++)for(r[u]=[],f=0;f<l;f++)r[u][f]=0;for(u=1;u<o;u++)for(f=1;f<l;f++)r[u][f]=(e.array[u-1][f-1]===a?1:0)+(e.array[u-1][f]===a?2:0)+(e.array[u][f-1]===a?8:0)+(e.array[u][f]===a?4:0);return r},this.pointinpoly=function(e,a){for(var r=!1,t=0,o=a.length-1;t<a.length;o=t++)r=a[t].y>e.y!=a[o].y>e.y&&e.x<(a[o].x-a[t].x)*(e.y-a[t].y)/(a[o].y-a[t].y)+a[t].x?!r:r;return r},this.pathscan_combined_lookup=[[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[13,3,0,1],[13,2,-1,0],[7,1,0,-1],[7,0,1,0]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[11,1,0,-1],[14,0,1,0],[14,3,0,1],[11,2,-1,0]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]]],this.pathscan=function(e,a){for(var r=[],t=0,o=0,l=0,c=0,n=e[0].length,i=e.length,s=0,y=!0,d=!1,b,g=0;g<i;g++)for(var f=0;f<n;f++)if(e[g][f]==4||e[g][f]==11)for(l=f,c=g,r[t]={},r[t].points=[],r[t].boundingbox=[l,c,l,c],r[t].holechildren=[],y=!1,o=0,d=e[g][f]==11,s=1;!y;){if(r[t].points[o]={},r[t].points[o].x=l-1,r[t].points[o].y=c-1,r[t].points[o].t=e[c][l],l-1<r[t].boundingbox[0]&&(r[t].boundingbox[0]=l-1),l-1>r[t].boundingbox[2]&&(r[t].boundingbox[2]=l-1),c-1<r[t].boundingbox[1]&&(r[t].boundingbox[1]=c-1),c-1>r[t].boundingbox[3]&&(r[t].boundingbox[3]=c-1),b=h.pathscan_combined_lookup[e[c][l]][s],e[c][l]=b[0],s=b[1],l+=b[2],c+=b[3],l-1===r[t].points[0].x&&c-1===r[t].points[0].y)if(y=!0,r[t].points.length<a)r.pop();else{if(r[t].isholepath=!!d,d){for(var u=0,v=[-1,-1,n+1,i+1],x=0;x<t;x++)!r[x].isholepath&&h.boundingboxincludes(r[x].boundingbox,r[t].boundingbox)&&h.boundingboxincludes(v,r[x].boundingbox)&&h.pointinpoly(r[t].points[0],r[x].points)&&(u=x,v=r[x].boundingbox);r[u].holechildren.push(t)}t++}o++}return r},this.boundingboxincludes=function(e,a){return e[0]<a[0]&&e[1]<a[1]&&e[2]>a[2]&&e[3]>a[3]},this.batchpathscan=function(e,a){var r=[];for(var t in e)e.hasOwnProperty(t)&&(r[t]=h.pathscan(e[t],a));return r},this.internodes=function(e,a){var r=[],t=0,o=0,l=0,c=0,n=0,i,s;for(i=0;i<e.length;i++)for(r[i]={},r[i].points=[],r[i].boundingbox=e[i].boundingbox,r[i].holechildren=e[i].holechildren,r[i].isholepath=e[i].isholepath,t=e[i].points.length,s=0;s<t;s++)o=(s+1)%t,l=(s+2)%t,c=(s-1+t)%t,n=(s-2+t)%t,a.rightangleenhance&&h.testrightangle(e[i],n,c,s,o,l)&&(r[i].points.length>0&&(r[i].points[r[i].points.length-1].linesegment=h.getdirection(r[i].points[r[i].points.length-1].x,r[i].points[r[i].points.length-1].y,e[i].points[s].x,e[i].points[s].y)),r[i].points.push({x:e[i].points[s].x,y:e[i].points[s].y,linesegment:h.getdirection(e[i].points[s].x,e[i].points[s].y,(e[i].points[s].x+e[i].points[o].x)/2,(e[i].points[s].y+e[i].points[o].y)/2)})),r[i].points.push({x:(e[i].points[s].x+e[i].points[o].x)/2,y:(e[i].points[s].y+e[i].points[o].y)/2,linesegment:h.getdirection((e[i].points[s].x+e[i].points[o].x)/2,(e[i].points[s].y+e[i].points[o].y)/2,(e[i].points[o].x+e[i].points[l].x)/2,(e[i].points[o].y+e[i].points[l].y)/2)});return r},this.testrightangle=function(e,a,r,t,o,l){return e.points[t].x===e.points[a].x&&e.points[t].x===e.points[r].x&&e.points[t].y===e.points[o].y&&e.points[t].y===e.points[l].y||e.points[t].y===e.points[a].y&&e.points[t].y===e.points[r].y&&e.points[t].x===e.points[o].x&&e.points[t].x===e.points[l].x},this.getdirection=function(e,a,r,t){var o=8;return e<r?a<t?o=1:a>t?o=7:o=0:e>r?a<t?o=3:a>t?o=5:o=4:a<t?o=2:a>t?o=6:o=8,o},this.batchinternodes=function(e,a){var r=[];for(var t in e)e.hasOwnProperty(t)&&(r[t]=h.internodes(e[t],a));return r},this.tracepath=function(e,a,r){var t=0,o,l,c,n={};for(n.segments=[],n.boundingbox=e.boundingbox,n.holechildren=e.holechildren,n.isholepath=e.isholepath;t<e.points.length;){for(o=e.points[t].linesegment,l=-1,c=t+1;(e.points[c].linesegment===o||e.points[c].linesegment===l||l===-1)&&c<e.points.length-1;)e.points[c].linesegment!==o&&l===-1&&(l=e.points[c].linesegment),c++;c===e.points.length-1&&(c=0),n.segments=n.segments.concat(h.fitseq(e,a,r,t,c)),c>0?t=c:t=e.points.length}return n},this.fitseq=function(e,a,r,t,o){if(o>e.points.length||o<0)return[];var l=t,c=0,n=!0,i,s,y,d=o-t;d<0&&(d+=e.points.length);for(var b=(e.points[o].x-e.points[t].x)/d,g=(e.points[o].y-e.points[t].y)/d,f=(t+1)%e.points.length,u;f!=o;)u=f-t,u<0&&(u+=e.points.length),i=e.points[t].x+b*u,s=e.points[t].y+g*u,y=(e.points[f].x-i)*(e.points[f].x-i)+(e.points[f].y-s)*(e.points[f].y-s),y>a&&(n=!1),y>c&&(l=f,c=y),f=(f+1)%e.points.length;if(n)return[{type:"L",x1:e.points[t].x,y1:e.points[t].y,x2:e.points[o].x,y2:e.points[o].y}];var v=l;n=!0,c=0;var x=(v-t)/d,w=(1-x)*(1-x),m=2*(1-x)*x,M=x*x,O=(w*e.points[t].x+M*e.points[o].x-e.points[v].x)/-m,P=(w*e.points[t].y+M*e.points[o].y-e.points[v].y)/-m;for(f=t+1;f!=o;)x=(f-t)/d,w=(1-x)*(1-x),m=2*(1-x)*x,M=x*x,i=w*e.points[t].x+m*O+M*e.points[o].x,s=w*e.points[t].y+m*P+M*e.points[o].y,y=(e.points[f].x-i)*(e.points[f].x-i)+(e.points[f].y-s)*(e.points[f].y-s),y>r&&(n=!1),y>c&&(l=f,c=y),f=(f+1)%e.points.length;if(n)return[{type:"Q",x1:e.points[t].x,y1:e.points[t].y,x2:O,y2:P,x3:e.points[o].x,y3:e.points[o].y}];var T=v;return h.fitseq(e,a,r,t,T).concat(h.fitseq(e,a,r,T,o))},this.batchtracepaths=function(e,a,r){var t=[];for(var o in e)e.hasOwnProperty(o)&&t.push(h.tracepath(e[o],a,r));return t},this.batchtracelayers=function(e,a,r){var t=[];for(var o in e)e.hasOwnProperty(o)&&(t[o]=h.batchtracepaths(e[o],a,r));return t},this.roundtodec=function(e,a){return+e.toFixed(a)},this.svgpathstring=function(e,a,r,t){var o=e.layers[a],l=o[r],c="",n;if(t.linefilter&&l.segments.length<3)return c;if(c="<path "+(t.desc?'desc="l '+a+" p "+r+'" ':"")+h.tosvgcolorstr(e.palette[a],t)+'d="',t.roundcoords===-1){for(c+="M "+l.segments[0].x1*t.scale+" "+l.segments[0].y1*t.scale+" ",n=0;n<l.segments.length;n++)c+=l.segments[n].type+" "+l.segments[n].x2*t.scale+" "+l.segments[n].y2*t.scale+" ",l.segments[n].hasOwnProperty("x3")&&(c+=l.segments[n].x3*t.scale+" "+l.segments[n].y3*t.scale+" ");c+="Z "}else{for(c+="M "+h.roundtodec(l.segments[0].x1*t.scale,t.roundcoords)+" "+h.roundtodec(l.segments[0].y1*t.scale,t.roundcoords)+" ",n=0;n<l.segments.length;n++)c+=l.segments[n].type+" "+h.roundtodec(l.segments[n].x2*t.scale,t.roundcoords)+" "+h.roundtodec(l.segments[n].y2*t.scale,t.roundcoords)+" ",l.segments[n].hasOwnProperty("x3")&&(c+=h.roundtodec(l.segments[n].x3*t.scale,t.roundcoords)+" "+h.roundtodec(l.segments[n].y3*t.scale,t.roundcoords)+" ");c+="Z "}for(var i=0;i<l.holechildren.length;i++){var s=o[l.holechildren[i]];if(t.roundcoords===-1)for(s.segments[s.segments.length-1].hasOwnProperty("x3")?c+="M "+s.segments[s.segments.length-1].x3*t.scale+" "+s.segments[s.segments.length-1].y3*t.scale+" ":c+="M "+s.segments[s.segments.length-1].x2*t.scale+" "+s.segments[s.segments.length-1].y2*t.scale+" ",n=s.segments.length-1;n>=0;n--)c+=s.segments[n].type+" ",s.segments[n].hasOwnProperty("x3")&&(c+=s.segments[n].x2*t.scale+" "+s.segments[n].y2*t.scale+" "),c+=s.segments[n].x1*t.scale+" "+s.segments[n].y1*t.scale+" ";else for(s.segments[s.segments.length-1].hasOwnProperty("x3")?c+="M "+h.roundtodec(s.segments[s.segments.length-1].x3*t.scale)+" "+h.roundtodec(s.segments[s.segments.length-1].y3*t.scale)+" ":c+="M "+h.roundtodec(s.segments[s.segments.length-1].x2*t.scale)+" "+h.roundtodec(s.segments[s.segments.length-1].y2*t.scale)+" ",n=s.segments.length-1;n>=0;n--)c+=s.segments[n].type+" ",s.segments[n].hasOwnProperty("x3")&&(c+=h.roundtodec(s.segments[n].x2*t.scale)+" "+h.roundtodec(s.segments[n].y2*t.scale)+" "),c+=h.roundtodec(s.segments[n].x1*t.scale)+" "+h.roundtodec(s.segments[n].y1*t.scale)+" ";c+="Z "}if(c+='" />',t.lcpr||t.qcpr){for(n=0;n<l.segments.length;n++)l.segments[n].hasOwnProperty("x3")&&t.qcpr&&(c+='<circle cx="'+l.segments[n].x2*t.scale+'" cy="'+l.segments[n].y2*t.scale+'" r="'+t.qcpr+'" fill="cyan" stroke-width="'+t.qcpr*.2+'" stroke="black" />',c+='<circle cx="'+l.segments[n].x3*t.scale+'" cy="'+l.segments[n].y3*t.scale+'" r="'+t.qcpr+'" fill="white" stroke-width="'+t.qcpr*.2+'" stroke="black" />',c+='<line x1="'+l.segments[n].x1*t.scale+'" y1="'+l.segments[n].y1*t.scale+'" x2="'+l.segments[n].x2*t.scale+'" y2="'+l.segments[n].y2*t.scale+'" stroke-width="'+t.qcpr*.2+'" stroke="cyan" />',c+='<line x1="'+l.segments[n].x2*t.scale+'" y1="'+l.segments[n].y2*t.scale+'" x2="'+l.segments[n].x3*t.scale+'" y2="'+l.segments[n].y3*t.scale+'" stroke-width="'+t.qcpr*.2+'" stroke="cyan" />'),!l.segments[n].hasOwnProperty("x3")&&t.lcpr&&(c+='<circle cx="'+l.segments[n].x2*t.scale+'" cy="'+l.segments[n].y2*t.scale+'" r="'+t.lcpr+'" fill="white" stroke-width="'+t.lcpr*.2+'" stroke="black" />');for(var i=0;i<l.holechildren.length;i++){var s=o[l.holechildren[i]];for(n=0;n<s.segments.length;n++)s.segments[n].hasOwnProperty("x3")&&t.qcpr&&(c+='<circle cx="'+s.segments[n].x2*t.scale+'" cy="'+s.segments[n].y2*t.scale+'" r="'+t.qcpr+'" fill="cyan" stroke-width="'+t.qcpr*.2+'" stroke="black" />',c+='<circle cx="'+s.segments[n].x3*t.scale+'" cy="'+s.segments[n].y3*t.scale+'" r="'+t.qcpr+'" fill="white" stroke-width="'+t.qcpr*.2+'" stroke="black" />',c+='<line x1="'+s.segments[n].x1*t.scale+'" y1="'+s.segments[n].y1*t.scale+'" x2="'+s.segments[n].x2*t.scale+'" y2="'+s.segments[n].y2*t.scale+'" stroke-width="'+t.qcpr*.2+'" stroke="cyan" />',c+='<line x1="'+s.segments[n].x2*t.scale+'" y1="'+s.segments[n].y2*t.scale+'" x2="'+s.segments[n].x3*t.scale+'" y2="'+s.segments[n].y3*t.scale+'" stroke-width="'+t.qcpr*.2+'" stroke="cyan" />'),!s.segments[n].hasOwnProperty("x3")&&t.lcpr&&(c+='<circle cx="'+s.segments[n].x2*t.scale+'" cy="'+s.segments[n].y2*t.scale+'" r="'+t.lcpr+'" fill="white" stroke-width="'+t.lcpr*.2+'" stroke="black" />')}}return c},this.getsvgstring=function(e,a){a=h.checkoptions(a);for(var r=e.width*a.scale,t=e.height*a.scale,o="<svg "+(a.viewbox?'viewBox="0 0 '+r+" "+t+'" ':'width="'+r+'" height="'+t+'" ')+'version="1.1" xmlns="http://www.w3.org/2000/svg" desc="Created with imagetracer.js version '+h.versionnumber+'" >',l=0;l<e.layers.length;l++)for(var c=0;c<e.layers[l].length;c++)e.layers[l][c].isholepath||(o+=h.svgpathstring(e,l,c,a));return o+="</svg>",o},this.compareNumbers=function(e,a){return e-a},this.torgbastr=function(e){return"rgba("+e.r+","+e.g+","+e.b+","+e.a+")"},this.tosvgcolorstr=function(e,a){return'fill="rgb('+e.r+","+e.g+","+e.b+')" stroke="rgb('+e.r+","+e.g+","+e.b+')" stroke-width="'+a.strokewidth+'" opacity="'+e.a/255+'" '},this.appendSVGString=function(e,a){var r;a?(r=document.getElementById(a),r||(r=document.createElement("div"),r.id=a,document.body.appendChild(r))):(r=document.createElement("div"),document.body.appendChild(r)),r.innerHTML+=e},this.gks=[[.27901,.44198,.27901],[.135336,.228569,.272192,.228569,.135336],[.086776,.136394,.178908,.195843,.178908,.136394,.086776],[.063327,.093095,.122589,.144599,.152781,.144599,.122589,.093095,.063327],[.049692,.069304,.089767,.107988,.120651,.125194,.120651,.107988,.089767,.069304,.049692]],this.blur=function(e,a,r){var t,o,l,c,n,i,s,y,d,b,g={width:e.width,height:e.height,data:[]};if(a=Math.floor(a),a<1)return e;a>5&&(a=5),r=Math.abs(r),r>1024&&(r=1024);var f=h.gks[a-1];for(o=0;o<e.height;o++)for(t=0;t<e.width;t++){for(i=0,s=0,y=0,d=0,b=0,l=-a;l<a+1;l++)t+l>0&&t+l<e.width&&(n=(o*e.width+t+l)*4,i+=e.data[n]*f[l+a],s+=e.data[n+1]*f[l+a],y+=e.data[n+2]*f[l+a],d+=e.data[n+3]*f[l+a],b+=f[l+a]);n=(o*e.width+t)*4,g.data[n]=Math.floor(i/b),g.data[n+1]=Math.floor(s/b),g.data[n+2]=Math.floor(y/b),g.data[n+3]=Math.floor(d/b)}var u=new Uint8ClampedArray(g.data);for(o=0;o<e.height;o++)for(t=0;t<e.width;t++){for(i=0,s=0,y=0,d=0,b=0,l=-a;l<a+1;l++)o+l>0&&o+l<e.height&&(n=((o+l)*e.width+t)*4,i+=u[n]*f[l+a],s+=u[n+1]*f[l+a],y+=u[n+2]*f[l+a],d+=u[n+3]*f[l+a],b+=f[l+a]);n=(o*e.width+t)*4,g.data[n]=Math.floor(i/b),g.data[n+1]=Math.floor(s/b),g.data[n+2]=Math.floor(y/b),g.data[n+3]=Math.floor(d/b)}for(o=0;o<e.height;o++)for(t=0;t<e.width;t++)n=(o*e.width+t)*4,c=Math.abs(g.data[n]-e.data[n])+Math.abs(g.data[n+1]-e.data[n+1])+Math.abs(g.data[n+2]-e.data[n+2])+Math.abs(g.data[n+3]-e.data[n+3]),c>r&&(g.data[n]=e.data[n],g.data[n+1]=e.data[n+1],g.data[n+2]=e.data[n+2],g.data[n+3]=e.data[n+3]);return g},this.loadImage=function(e,a,r){var t=new Image;r&&r.corsenabled&&(t.crossOrigin="Anonymous"),t.onload=function(){var o=document.createElement("canvas");o.width=t.width,o.height=t.height;var l=o.getContext("2d");l.drawImage(t,0,0),a(o)},t.src=e},this.getImgdata=function(e){var a=e.getContext("2d");return a.getImageData(0,0,e.width,e.height)},this.specpalette=[{r:0,g:0,b:0,a:255},{r:128,g:128,b:128,a:255},{r:0,g:0,b:128,a:255},{r:64,g:64,b:128,a:255},{r:192,g:192,b:192,a:255},{r:255,g:255,b:255,a:255},{r:128,g:128,b:192,a:255},{r:0,g:0,b:192,a:255},{r:128,g:0,b:0,a:255},{r:128,g:64,b:64,a:255},{r:128,g:0,b:128,a:255},{r:168,g:168,b:168,a:255},{r:192,g:128,b:128,a:255},{r:192,g:0,b:0,a:255},{r:255,g:255,b:255,a:255},{r:0,g:128,b:0,a:255}],this.drawLayers=function(e,a,r,t){r=r||1;var o,l,c,n,i,s;t?(s=document.getElementById(t),s||(s=document.createElement("div"),s.id=t,document.body.appendChild(s))):(s=document.createElement("div"),document.body.appendChild(s));for(i in e)if(e.hasOwnProperty(i)){o=e[i][0].length,l=e[i].length;var y=document.createElement("canvas");y.width=o*r,y.height=l*r;var d=y.getContext("2d");for(n=0;n<l;n++)for(c=0;c<o;c++)d.fillStyle=h.torgbastr(a[e[i][n][c]%a.length]),d.fillRect(c*r,n*r,r,r);s.appendChild(y)}}}typeof define=="function"&&define.amd?define(function(){return new k}):typeof module<"u"?module.exports=new k:typeof self<"u"?self.ImageTracer=new k:window.ImageTracer=new k})();
